"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/update-stats";
exports.ids = ["pages/api/update-stats"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Database: () => (/* binding */ Database)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n// 文件路径: lib/db.js\n\n\n// 数据文件路径\nconst DATA_DIR = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'data');\nconst STOCKS_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(DATA_DIR, 'stocks.json');\nconst STATS_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(DATA_DIR, 'update_stats.json');\n// 确保数据目录存在\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(DATA_DIR)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(DATA_DIR, {\n        recursive: true\n    });\n}\n// 读取数据文件\nfunction readStocksData() {\n    try {\n        if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(STOCKS_FILE)) {\n            const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(STOCKS_FILE, 'utf8');\n            return JSON.parse(data);\n        }\n    } catch (error) {\n        console.error('读取股票数据失败:', error);\n    }\n    return [];\n}\nfunction readStatsData() {\n    try {\n        if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(STATS_FILE)) {\n            const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(STATS_FILE, 'utf8');\n            return JSON.parse(data);\n        }\n    } catch (error) {\n        console.error('读取统计数据失败:', error);\n    }\n    return [];\n}\n// 写入数据文件\nfunction writeStocksData(data) {\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(STOCKS_FILE, JSON.stringify(data, null, 2));\n    } catch (error) {\n        console.error('写入股票数据失败:', error);\n    }\n}\nfunction writeStatsData(data) {\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(STATS_FILE, JSON.stringify(data, null, 2));\n    } catch (error) {\n        console.error('写入统计数据失败:', error);\n    }\n}\n/**\n * 模拟数据库操作工具类\n */ class Database {\n    /**\n   * 获取所有股票数据\n   */ static async getStocks() {\n        return readStocksData();\n    }\n    /**\n   * 更新股票数据\n   */ static async updateStock(symbol, data) {\n        const stocksData = readStocksData();\n        const existingIndex = stocksData.findIndex((stock)=>stock.symbol === symbol);\n        const stockData = {\n            symbol,\n            ...data,\n            last_updated: new Date().toISOString()\n        };\n        if (existingIndex >= 0) {\n            stocksData[existingIndex] = stockData;\n        } else {\n            stocksData.push(stockData);\n        }\n        writeStocksData(stocksData);\n    }\n    /**\n   * 批量更新股票数据\n   */ static async batchUpdateStocks(stocks) {\n        const stocksData = readStocksData();\n        for (const stock of stocks){\n            const existingIndex = stocksData.findIndex((s)=>s.symbol === stock.symbol);\n            const stockData = {\n                ...stock,\n                last_updated: new Date().toISOString()\n            };\n            if (existingIndex >= 0) {\n                stocksData[existingIndex] = stockData;\n            } else {\n                stocksData.push(stockData);\n            }\n        }\n        writeStocksData(stocksData);\n    }\n    /**\n   * 记录更新统计\n   */ static async logUpdateStats(stats) {\n        const updateStatsData = readStatsData();\n        updateStatsData.push({\n            id: updateStatsData.length + 1,\n            ...stats,\n            created_at: new Date().toISOString()\n        });\n        writeStatsData(updateStatsData);\n    }\n    /**\n   * 获取更新统计历史\n   */ static async getUpdateStats(limit = 10) {\n        const updateStatsData = readStatsData();\n        return updateStatsData.sort((a, b)=>new Date(b.created_at) - new Date(a.created_at)).slice(0, limit);\n    }\n    /**\n   * 清空所有数据（仅用于测试）\n   */ static async clearAll() {\n        writeStocksData([]);\n        writeStatsData([]);\n    }\n    /**\n   * 获取数据统计\n   */ static async getDataStats() {\n        const stocksData = readStocksData();\n        const now = new Date();\n        const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n        const totalStocks = stocksData.length;\n        const stocksWithData = stocksData.filter((stock)=>stock.last_price && stock.change_amount !== undefined).length;\n        const recentlyUpdated = stocksData.filter((stock)=>stock.last_updated && new Date(stock.last_updated) > oneDayAgo).length;\n        const stocksWithTags = stocksData.filter((stock)=>stock.tags && stock.tags.length > 0).length;\n        const incompleteStocks = stocksData.filter((stock)=>!stock.last_price || stock.change_amount === undefined || stock.change_percent === undefined).length;\n        const anomalousStocks = stocksData.filter((stock)=>stock.last_price <= 0 || Math.abs(stock.change_percent) > 50).length;\n        const recentUpdates = await this.getUpdateStats(5);\n        return {\n            totalStocks,\n            stocksWithData,\n            recentlyUpdated,\n            stocksWithTags,\n            incompleteStocks,\n            anomalousStocks,\n            recentUpdates,\n            completeness: totalStocks > 0 ? stocksWithData / totalStocks * 100 : 0,\n            freshness: totalStocks > 0 ? recentlyUpdated / totalStocks * 100 : 0,\n            tagCoverage: totalStocks > 0 ? stocksWithTags / totalStocks * 100 : 0,\n            dataQuality: totalStocks > 0 ? (totalStocks - anomalousStocks) / totalStocks * 100 : 0\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixtQkFBbUJ0QyxXQUFXK0IsTUFBTSxDQUFDNUIsQ0FBQUEsUUFDekMsQ0FBQ0EsTUFBTTZCLFVBQVUsSUFBSTdCLE1BQU04QixhQUFhLEtBQUtDLGFBQWEvQixNQUFNb0MsY0FBYyxLQUFLTCxXQUNuRmxCLE1BQU07UUFFUixNQUFNd0Isa0JBQWtCeEMsV0FBVytCLE1BQU0sQ0FBQzVCLENBQUFBLFFBQ3hDQSxNQUFNNkIsVUFBVSxJQUFJLEtBQUtTLEtBQUtDLEdBQUcsQ0FBQ3ZDLE1BQU1vQyxjQUFjLElBQUksSUFDMUR2QixNQUFNO1FBRVIsTUFBTTJCLGdCQUFnQixNQUFNLElBQUksQ0FBQ3pCLGNBQWMsQ0FBQztRQUVoRCxPQUFPO1lBQ0xXO1lBQ0FDO1lBQ0FLO1lBQ0FDO1lBQ0FFO1lBQ0FFO1lBQ0FHO1lBQ0FDLGNBQWNmLGNBQWMsSUFBSSxpQkFBa0JBLGNBQWUsTUFBTTtZQUN2RWdCLFdBQVdoQixjQUFjLElBQUksa0JBQW1CQSxjQUFlLE1BQU07WUFDckVpQixhQUFhakIsY0FBYyxJQUFJLGlCQUFrQkEsY0FBZSxNQUFNO1lBQ3RFa0IsYUFBYWxCLGNBQWMsSUFBSSxDQUFFQSxjQUFjVyxlQUFjLElBQUtYLGNBQWUsTUFBTTtRQUN6RjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkQ6XFzkuqflk4HlvIDlj5FcXOaWsOmhueebrlxcVGFnLUV4cGxvcmVyXFxsaWJcXGRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOaWh+S7tui3r+W+hDogbGliL2RiLmpzXG5cbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuLy8g5pWw5o2u5paH5Lu26Lev5b6EXG5jb25zdCBEQVRBX0RJUiA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YScpO1xuY29uc3QgU1RPQ0tTX0ZJTEUgPSBwYXRoLmpvaW4oREFUQV9ESVIsICdzdG9ja3MuanNvbicpO1xuY29uc3QgU1RBVFNfRklMRSA9IHBhdGguam9pbihEQVRBX0RJUiwgJ3VwZGF0ZV9zdGF0cy5qc29uJyk7XG5cbi8vIOehruS/neaVsOaNruebruW9leWtmOWcqFxuaWYgKCFmcy5leGlzdHNTeW5jKERBVEFfRElSKSkge1xuICBmcy5ta2RpclN5bmMoREFUQV9ESVIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xufVxuXG4vLyDor7vlj5bmlbDmja7mlofku7ZcbmZ1bmN0aW9uIHJlYWRTdG9ja3NEYXRhKCkge1xuICB0cnkge1xuICAgIGlmIChmcy5leGlzdHNTeW5jKFNUT0NLU19GSUxFKSkge1xuICAgICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhTVE9DS1NfRklMRSwgJ3V0ZjgnKTtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfor7vlj5bogqHnpajmlbDmja7lpLHotKU6JywgZXJyb3IpO1xuICB9XG4gIHJldHVybiBbXTtcbn1cblxuZnVuY3Rpb24gcmVhZFN0YXRzRGF0YSgpIHtcbiAgdHJ5IHtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhTVEFUU19GSUxFKSkge1xuICAgICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhTVEFUU19GSUxFLCAndXRmOCcpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+ivu+WPlue7n+iuoeaVsOaNruWksei0pTonLCBlcnJvcik7XG4gIH1cbiAgcmV0dXJuIFtdO1xufVxuXG4vLyDlhpnlhaXmlbDmja7mlofku7ZcbmZ1bmN0aW9uIHdyaXRlU3RvY2tzRGF0YShkYXRhKSB7XG4gIHRyeSB7XG4gICAgZnMud3JpdGVGaWxlU3luYyhTVE9DS1NfRklMRSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+WGmeWFpeiCoeelqOaVsOaNruWksei0pTonLCBlcnJvcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gd3JpdGVTdGF0c0RhdGEoZGF0YSkge1xuICB0cnkge1xuICAgIGZzLndyaXRlRmlsZVN5bmMoU1RBVFNfRklMRSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+WGmeWFpee7n+iuoeaVsOaNruWksei0pTonLCBlcnJvcik7XG4gIH1cbn1cblxuLyoqXG4gKiDmqKHmi5/mlbDmja7lupPmk43kvZzlt6XlhbfnsbtcbiAqL1xuZXhwb3J0IGNsYXNzIERhdGFiYXNlIHtcbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieiCoeelqOaVsOaNrlxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldFN0b2NrcygpIHtcbiAgICByZXR1cm4gcmVhZFN0b2Nrc0RhdGEoKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIOabtOaWsOiCoeelqOaVsOaNrlxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHVwZGF0ZVN0b2NrKHN5bWJvbCwgZGF0YSkge1xuICAgIGNvbnN0IHN0b2Nrc0RhdGEgPSByZWFkU3RvY2tzRGF0YSgpO1xuICAgIGNvbnN0IGV4aXN0aW5nSW5kZXggPSBzdG9ja3NEYXRhLmZpbmRJbmRleChzdG9jayA9PiBzdG9jay5zeW1ib2wgPT09IHN5bWJvbCk7XG4gICAgY29uc3Qgc3RvY2tEYXRhID0ge1xuICAgICAgc3ltYm9sLFxuICAgICAgLi4uZGF0YSxcbiAgICAgIGxhc3RfdXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgICBcbiAgICBpZiAoZXhpc3RpbmdJbmRleCA+PSAwKSB7XG4gICAgICBzdG9ja3NEYXRhW2V4aXN0aW5nSW5kZXhdID0gc3RvY2tEYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdG9ja3NEYXRhLnB1c2goc3RvY2tEYXRhKTtcbiAgICB9XG4gICAgXG4gICAgd3JpdGVTdG9ja3NEYXRhKHN0b2Nrc0RhdGEpO1xuICB9XG4gIFxuICAvKipcbiAgICog5om56YeP5pu05paw6IKh56Wo5pWw5o2uXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgYmF0Y2hVcGRhdGVTdG9ja3Moc3RvY2tzKSB7XG4gICAgY29uc3Qgc3RvY2tzRGF0YSA9IHJlYWRTdG9ja3NEYXRhKCk7XG4gICAgXG4gICAgZm9yIChjb25zdCBzdG9jayBvZiBzdG9ja3MpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nSW5kZXggPSBzdG9ja3NEYXRhLmZpbmRJbmRleChzID0+IHMuc3ltYm9sID09PSBzdG9jay5zeW1ib2wpO1xuICAgICAgY29uc3Qgc3RvY2tEYXRhID0ge1xuICAgICAgICAuLi5zdG9jayxcbiAgICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGlmIChleGlzdGluZ0luZGV4ID49IDApIHtcbiAgICAgICAgc3RvY2tzRGF0YVtleGlzdGluZ0luZGV4XSA9IHN0b2NrRGF0YTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0b2Nrc0RhdGEucHVzaChzdG9ja0RhdGEpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB3cml0ZVN0b2Nrc0RhdGEoc3RvY2tzRGF0YSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDorrDlvZXmm7TmlrDnu5/orqFcbiAgICovXG4gIHN0YXRpYyBhc3luYyBsb2dVcGRhdGVTdGF0cyhzdGF0cykge1xuICAgIGNvbnN0IHVwZGF0ZVN0YXRzRGF0YSA9IHJlYWRTdGF0c0RhdGEoKTtcbiAgICB1cGRhdGVTdGF0c0RhdGEucHVzaCh7XG4gICAgICBpZDogdXBkYXRlU3RhdHNEYXRhLmxlbmd0aCArIDEsXG4gICAgICAuLi5zdGF0cyxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0pO1xuICAgIHdyaXRlU3RhdHNEYXRhKHVwZGF0ZVN0YXRzRGF0YSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDojrflj5bmm7TmlrDnu5/orqHljoblj7JcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRVcGRhdGVTdGF0cyhsaW1pdCA9IDEwKSB7XG4gICAgY29uc3QgdXBkYXRlU3RhdHNEYXRhID0gcmVhZFN0YXRzRGF0YSgpO1xuICAgIHJldHVybiB1cGRhdGVTdGF0c0RhdGFcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZWRfYXQpIC0gbmV3IERhdGUoYS5jcmVhdGVkX2F0KSlcbiAgICAgIC5zbGljZSgwLCBsaW1pdCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiDmuIXnqbrmiYDmnInmlbDmja7vvIjku4XnlKjkuo7mtYvor5XvvIlcbiAgICovXG4gIHN0YXRpYyBhc3luYyBjbGVhckFsbCgpIHtcbiAgICB3cml0ZVN0b2Nrc0RhdGEoW10pO1xuICAgIHdyaXRlU3RhdHNEYXRhKFtdKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIOiOt+WPluaVsOaNrue7n+iuoVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldERhdGFTdGF0cygpIHtcbiAgICBjb25zdCBzdG9ja3NEYXRhID0gcmVhZFN0b2Nrc0RhdGEoKTtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IG9uZURheUFnbyA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICBcbiAgICBjb25zdCB0b3RhbFN0b2NrcyA9IHN0b2Nrc0RhdGEubGVuZ3RoO1xuICAgIGNvbnN0IHN0b2Nrc1dpdGhEYXRhID0gc3RvY2tzRGF0YS5maWx0ZXIoc3RvY2sgPT4gXG4gICAgICBzdG9jay5sYXN0X3ByaWNlICYmIHN0b2NrLmNoYW5nZV9hbW91bnQgIT09IHVuZGVmaW5lZFxuICAgICkubGVuZ3RoO1xuICAgIFxuICAgIGNvbnN0IHJlY2VudGx5VXBkYXRlZCA9IHN0b2Nrc0RhdGEuZmlsdGVyKHN0b2NrID0+IFxuICAgICAgc3RvY2subGFzdF91cGRhdGVkICYmIG5ldyBEYXRlKHN0b2NrLmxhc3RfdXBkYXRlZCkgPiBvbmVEYXlBZ29cbiAgICApLmxlbmd0aDtcbiAgICBcbiAgICBjb25zdCBzdG9ja3NXaXRoVGFncyA9IHN0b2Nrc0RhdGEuZmlsdGVyKHN0b2NrID0+IFxuICAgICAgc3RvY2sudGFncyAmJiBzdG9jay50YWdzLmxlbmd0aCA+IDBcbiAgICApLmxlbmd0aDtcbiAgICBcbiAgICBjb25zdCBpbmNvbXBsZXRlU3RvY2tzID0gc3RvY2tzRGF0YS5maWx0ZXIoc3RvY2sgPT4gXG4gICAgICAhc3RvY2subGFzdF9wcmljZSB8fCBzdG9jay5jaGFuZ2VfYW1vdW50ID09PSB1bmRlZmluZWQgfHwgc3RvY2suY2hhbmdlX3BlcmNlbnQgPT09IHVuZGVmaW5lZFxuICAgICkubGVuZ3RoO1xuICAgIFxuICAgIGNvbnN0IGFub21hbG91c1N0b2NrcyA9IHN0b2Nrc0RhdGEuZmlsdGVyKHN0b2NrID0+IFxuICAgICAgc3RvY2subGFzdF9wcmljZSA8PSAwIHx8IE1hdGguYWJzKHN0b2NrLmNoYW5nZV9wZXJjZW50KSA+IDUwXG4gICAgKS5sZW5ndGg7XG4gICAgXG4gICAgY29uc3QgcmVjZW50VXBkYXRlcyA9IGF3YWl0IHRoaXMuZ2V0VXBkYXRlU3RhdHMoNSk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsU3RvY2tzLFxuICAgICAgc3RvY2tzV2l0aERhdGEsXG4gICAgICByZWNlbnRseVVwZGF0ZWQsXG4gICAgICBzdG9ja3NXaXRoVGFncyxcbiAgICAgIGluY29tcGxldGVTdG9ja3MsXG4gICAgICBhbm9tYWxvdXNTdG9ja3MsXG4gICAgICByZWNlbnRVcGRhdGVzLFxuICAgICAgY29tcGxldGVuZXNzOiB0b3RhbFN0b2NrcyA+IDAgPyAoc3RvY2tzV2l0aERhdGEgLyB0b3RhbFN0b2NrcykgKiAxMDAgOiAwLFxuICAgICAgZnJlc2huZXNzOiB0b3RhbFN0b2NrcyA+IDAgPyAocmVjZW50bHlVcGRhdGVkIC8gdG90YWxTdG9ja3MpICogMTAwIDogMCxcbiAgICAgIHRhZ0NvdmVyYWdlOiB0b3RhbFN0b2NrcyA+IDAgPyAoc3RvY2tzV2l0aFRhZ3MgLyB0b3RhbFN0b2NrcykgKiAxMDAgOiAwLFxuICAgICAgZGF0YVF1YWxpdHk6IHRvdGFsU3RvY2tzID4gMCA/ICgodG90YWxTdG9ja3MgLSBhbm9tYWxvdXNTdG9ja3MpIC8gdG90YWxTdG9ja3MpICogMTAwIDogMFxuICAgIH07XG4gIH1cbn0iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiREFUQV9ESVIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsIlNUT0NLU19GSUxFIiwiU1RBVFNfRklMRSIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJyZWFkU3RvY2tzRGF0YSIsImRhdGEiLCJyZWFkRmlsZVN5bmMiLCJKU09OIiwicGFyc2UiLCJlcnJvciIsImNvbnNvbGUiLCJyZWFkU3RhdHNEYXRhIiwid3JpdGVTdG9ja3NEYXRhIiwid3JpdGVGaWxlU3luYyIsInN0cmluZ2lmeSIsIndyaXRlU3RhdHNEYXRhIiwiRGF0YWJhc2UiLCJnZXRTdG9ja3MiLCJ1cGRhdGVTdG9jayIsInN5bWJvbCIsInN0b2Nrc0RhdGEiLCJleGlzdGluZ0luZGV4IiwiZmluZEluZGV4Iiwic3RvY2siLCJzdG9ja0RhdGEiLCJsYXN0X3VwZGF0ZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJwdXNoIiwiYmF0Y2hVcGRhdGVTdG9ja3MiLCJzdG9ja3MiLCJzIiwibG9nVXBkYXRlU3RhdHMiLCJzdGF0cyIsInVwZGF0ZVN0YXRzRGF0YSIsImlkIiwibGVuZ3RoIiwiY3JlYXRlZF9hdCIsImdldFVwZGF0ZVN0YXRzIiwibGltaXQiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsImNsZWFyQWxsIiwiZ2V0RGF0YVN0YXRzIiwibm93Iiwib25lRGF5QWdvIiwiZ2V0VGltZSIsInRvdGFsU3RvY2tzIiwic3RvY2tzV2l0aERhdGEiLCJmaWx0ZXIiLCJsYXN0X3ByaWNlIiwiY2hhbmdlX2Ftb3VudCIsInVuZGVmaW5lZCIsInJlY2VudGx5VXBkYXRlZCIsInN0b2Nrc1dpdGhUYWdzIiwidGFncyIsImluY29tcGxldGVTdG9ja3MiLCJjaGFuZ2VfcGVyY2VudCIsImFub21hbG91c1N0b2NrcyIsIk1hdGgiLCJhYnMiLCJyZWNlbnRVcGRhdGVzIiwiY29tcGxldGVuZXNzIiwiZnJlc2huZXNzIiwidGFnQ292ZXJhZ2UiLCJkYXRhUXVhbGl0eSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-stats&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-stats.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-stats&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-stats.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_update_stats_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pages\\api\\update-stats.js */ \"(api-node)/./pages/api/update-stats.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_update_stats_js__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_update_stats_js__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/update-stats\",\n        pathname: \"/api/update-stats\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_update_stats_js__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    projectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/update-stats\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: undefined,\n                multiZoneDraftMode: Boolean(\"false\"),\n                trustHostHeader: undefined,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/update-stats\",\n                projectDir:  false || '',\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGdXBkYXRlLXN0YXRzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUN1cGRhdGUtc3RhdHMuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXVEO0FBQ0M7QUFDdUM7QUFDckM7QUFDMUQ7QUFDMEQ7QUFDYztBQUNGO0FBQ3RFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCxnQkFBZ0IsTUFBdUM7QUFDdkQsQ0FBQztBQUNNO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUI7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUNBQW1DO0FBQy9DO0FBQ0E7QUFDQSx1QkFBdUIsNEVBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNkNBQTZDLFNBQTZDO0FBQzFGLDRDQUE0QyxPQUF3QztBQUNwRixpQ0FBaUMsU0FBb0M7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE1BQXVDO0FBQ25FO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0ZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxRUFBUztBQUNqQixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VuZEVycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFx1cGRhdGUtc3RhdHMuanNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXBkYXRlLXN0YXRzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBkYXRlLXN0YXRzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmQsXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJ1xufSk7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvdXBkYXRlLXN0YXRzXCI7XG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIHRvIHByb2Nlc3MgZHluYW1pYyByb3V0ZXMgcHJvcGVybHlcbiAgICAvLyBUT0RPOiBmaXggdHVyYm9wYWNrIHByb3ZpZGluZyBkaWZmZXJpbmcgdmFsdWUgZnJvbSB3ZWJwYWNrXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xuICAgICAgICBzcmNQYWdlID0gc3JjUGFnZS5yZXBsYWNlKC9cXC9pbmRleCQvLCAnJykgfHwgJy8nO1xuICAgIH1cbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xuICAgICAgICBzcmNQYWdlXG4gICAgfSk7XG4gICAgaWYgKCFwcmVwYXJlUmVzdWx0KSB7XG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xuICAgICAgICByZXMuZW5kKCdCYWQgUmVxdWVzdCcpO1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgeyBxdWVyeSwgcGFyYW1zLCBwcmVyZW5kZXJNYW5pZmVzdCB9ID0gcHJlcGFyZVJlc3VsdDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBtZXRob2QgPSByZXEubWV0aG9kIHx8ICdHRVQnO1xuICAgICAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcbiAgICAgICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICAgICAgY29uc3Qgb25SZXF1ZXN0RXJyb3IgPSByb3V0ZU1vZHVsZS5pbnN0cnVtZW50YXRpb25PblJlcXVlc3RFcnJvci5iaW5kKHJvdXRlTW9kdWxlKTtcbiAgICAgICAgY29uc3QgaW52b2tlUm91dGVNb2R1bGUgPSBhc3luYyAoc3Bhbik9PnJvdXRlTW9kdWxlLnJlbmRlcihyZXEsIHJlcywge1xuICAgICAgICAgICAgICAgIHF1ZXJ5OiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBhcmFtcyxcbiAgICAgICAgICAgICAgICBhbGxvd2VkUmV2YWxpZGF0ZUhlYWRlcktleXM6IHByb2Nlc3MuZW52Ll9fTkVYVF9BTExPV0VEX1JFVkFMSURBVEVfSEVBREVSUyxcbiAgICAgICAgICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGU6IEJvb2xlYW4ocHJvY2Vzcy5lbnYuX19ORVhUX01VTFRJX1pPTkVfRFJBRlRfTU9ERSksXG4gICAgICAgICAgICAgICAgdHJ1c3RIb3N0SGVhZGVyOiBwcm9jZXNzLmVudi5fX05FWFRfVFJVU1RfSE9TVF9IRUFERVIsXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZ2V0IHRoaXMgZnJvbSBmcm9tIHJ1bnRpbWUgZW52IHNvIG1hbmlmZXN0XG4gICAgICAgICAgICAgICAgLy8gZG9lc24ndCBuZWVkIHRvIGxvYWRcbiAgICAgICAgICAgICAgICBwcmV2aWV3UHJvcHM6IHByZXJlbmRlck1hbmlmZXN0LnByZXZpZXcsXG4gICAgICAgICAgICAgICAgcHJvcGFnYXRlRXJyb3I6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRldjogcm91dGVNb2R1bGUuaXNEZXYsXG4gICAgICAgICAgICAgICAgcGFnZTogXCIvYXBpL3VwZGF0ZS1zdGF0c1wiLFxuICAgICAgICAgICAgICAgIHByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiAoLi4uYXJncyk9Pm9uUmVxdWVzdEVycm9yKHJlcSwgLi4uYXJncylcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGludm9rZVJvdXRlTW9kdWxlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gd2UgcmUtdGhyb3cgaW4gZGV2IHRvIHNob3cgdGhlIGVycm9yIG92ZXJsYXlcbiAgICAgICAgaWYgKHJvdXRlTW9kdWxlLmlzRGV2KSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcyBpcyB0ZWNobmljYWxseSBhbiBpbnZhcmlhbnQgYXMgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgLy8gc2hvdWxkIGJlIGRvbmUgaW5zaWRlIG9mIGFwaS1yZXNvbHZlciBvbkVycm9yXG4gICAgICAgIHNlbmRFcnJvcihyZXMsIDUwMCwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicpO1xuICAgIH0gZmluYWxseXtcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWxsb3cgYW55IHdhaXRVbnRpbCB3b3JrIGluIHBhZ2VzIEFQSSByb3V0ZXMgY3VycmVudGx5XG4gICAgICAgIC8vIHNvIGlmIGNhbGxiYWNrIGlzIHByZXNlbnQgcmV0dXJuIHdpdGggcmVzb2x2ZWQgcHJvbWlzZSBzaW5jZSBub1xuICAgICAgICAvLyBwZW5kaW5nIHdvcmtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-stats&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-stats.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/update-stats.js":
/*!***********************************!*\
  !*** ./pages/api/update-stats.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/db */ \"(api-node)/./lib/db.js\");\n\nasync function handler(req, res) {\n    if (req.method !== 'GET') {\n        return res.status(405).json({\n            error: 'Method not allowed'\n        });\n    }\n    try {\n        const updateStats = await _lib_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getUpdateStats();\n        res.status(200).json({\n            success: true,\n            data: updateStats\n        });\n    } catch (error) {\n        console.error('获取更新统计失败:', error);\n        res.status(500).json({\n            success: false,\n            error: '获取更新统计失败'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS91cGRhdGUtc3RhdHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBb0M7QUFFckIsZUFBZUMsUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQzVDLElBQUlELElBQUlFLE1BQU0sS0FBSyxPQUFPO1FBQ3hCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFxQjtJQUM1RDtJQUVBLElBQUk7UUFDRixNQUFNQyxjQUFjLE1BQU1SLDhEQUF1QjtRQUVqREcsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUNuQkksU0FBUztZQUNUQyxNQUFNSDtRQUNSO0lBQ0YsRUFBRSxPQUFPRCxPQUFPO1FBQ2RLLFFBQVFMLEtBQUssQ0FBQyxhQUFhQTtRQUMzQkosSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUNuQkksU0FBUztZQUNUSCxPQUFPO1FBQ1Q7SUFDRjtBQUNGIiwic291cmNlcyI6WyJEOlxc5Lqn5ZOB5byA5Y+RXFzmlrDpobnnm65cXFRhZy1FeHBsb3JlclxccGFnZXNcXGFwaVxcdXBkYXRlLXN0YXRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEYXRhYmFzZSBmcm9tICcuLi8uLi9saWIvZGInO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgdXBkYXRlU3RhdHMgPSBhd2FpdCBEYXRhYmFzZS5nZXRVcGRhdGVTdGF0cygpO1xuICAgIFxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB1cGRhdGVTdGF0c1xuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluabtOaWsOe7n+iuoeWksei0pTonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICfojrflj5bmm7TmlrDnu5/orqHlpLHotKUnIFxuICAgIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbIkRhdGFiYXNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInVwZGF0ZVN0YXRzIiwiZ2V0VXBkYXRlU3RhdHMiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/update-stats.js\n");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-stats&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-stats.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();