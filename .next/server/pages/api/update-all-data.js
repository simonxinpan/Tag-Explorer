"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/update-all-data";
exports.ids = ["pages/api/update-all-data"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = import("pg");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-all-data&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-all-data.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-all-data&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-all-data.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_update_all_data_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\update-all-data.js */ \"(api)/./pages/api/update-all-data.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_update_all_data_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_update_all_data_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/update-all-data\",\n        pathname: \"/api/update-all-data\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_update_all_data_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwZGF0ZS1hbGwtZGF0YSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdXBkYXRlLWFsbC1kYXRhLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywwREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGFnLWV4cGxvcmVyLz9hZDNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdXBkYXRlLWFsbC1kYXRhLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXBkYXRlLWFsbC1kYXRhXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBkYXRlLWFsbC1kYXRhXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-all-data&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-all-data.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/update-all-data.js":
/*!**************************************!*\
  !*** ./pages/api/update-all-data.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n// /api/update-all-data.js - 统一的数据更新API\nasync function handler(req, res) {\n    // 验证授权\n    if (req.headers[\"authorization\"] !== `Bearer ${process.env.CRON_SECRET}`) {\n        return res.status(401).json({\n            error: \"Unauthorized\"\n        });\n    }\n    console.log(\"===== Starting unified data update job =====\");\n    try {\n        // 创建数据库连接池\n        const { Pool } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! pg */ \"pg\"));\n        const pool = new Pool({\n            connectionString: process.env.NEON_DATABASE_URL,\n            ssl: {\n                rejectUnauthorized: false\n            }\n        });\n        const client = await pool.connect();\n        try {\n            await client.query(\"BEGIN\");\n            // 第一步：更新股票基础数据\n            console.log(\"Step 1: Updating stock data...\");\n            await updateStockData(client);\n            // 第二步：更新动态标签\n            console.log(\"Step 2: Updating dynamic tags...\");\n            await updateDynamicTags(client);\n            await client.query(\"COMMIT\");\n            console.log(\"===== All updates completed successfully =====\");\n            res.status(200).json({\n                success: true,\n                message: \"All data updated successfully\",\n                timestamp: new Date().toISOString()\n            });\n        } catch (error) {\n            await client.query(\"ROLLBACK\");\n            throw error;\n        } finally{\n            client.release();\n            await pool.end();\n        }\n    } catch (error) {\n        console.error(\"Update job failed:\", error);\n        res.status(500).json({\n            error: \"Update failed\",\n            message: error.message,\n            timestamp: new Date().toISOString()\n        });\n    }\n}\n// 更新股票数据的函数\nasync function updateStockData(client) {\n    try {\n        // 获取Polygon快照数据\n        const polygonData = await getPolygonSnapshot(process.env.POLYGON_API_KEY);\n        if (!polygonData || polygonData.length === 0) {\n            console.log(\"No Polygon data available, skipping stock updates\");\n            return;\n        }\n        console.log(`Processing ${polygonData.length} stocks from Polygon`);\n        // 批量更新股票数据\n        for (const stock of polygonData.slice(0, 100)){\n            try {\n                const ticker = stock.T;\n                const closePrice = stock.c;\n                const changePercent = ((stock.c - stock.o) / stock.o * 100).toFixed(2);\n                // 获取Finnhub财务数据\n                const finnhubData = await getFinnhubMetrics(ticker, process.env.FINNHUB_API_KEY);\n                // 更新股票表\n                await client.query(`UPDATE stocks SET \n                     last_price = $1, \n                     change_percent = $2, \n                     market_cap = $3,\n                     last_updated = NOW()\n                     WHERE ticker = $4`, [\n                    closePrice,\n                    changePercent,\n                    finnhubData?.marketCapitalization,\n                    ticker\n                ]);\n            } catch (stockError) {\n                console.error(`Error updating stock ${stock.T}:`, stockError.message);\n                continue;\n            }\n        }\n        console.log(\"Stock data update completed\");\n    } catch (error) {\n        console.error(\"Stock data update failed:\", error);\n        throw error;\n    }\n}\n// 更新动态标签的函数\nasync function updateDynamicTags(client) {\n    try {\n        // 获取所有有数据的股票\n        const { rows: stocks } = await client.query(`SELECT ticker, name_zh, sector_zh, market_cap, last_price, \n             change_percent, volume, pe_ratio \n             FROM stocks \n             WHERE last_price IS NOT NULL \n             ORDER BY market_cap DESC NULLS LAST \n             LIMIT 200`);\n        console.log(`Processing dynamic tags for ${stocks.length} stocks`);\n        for (const stock of stocks){\n            try {\n                // 计算动态标签\n                const tags = calculateDynamicTags(stock);\n                // 清理旧的动态标签\n                await client.query(`DELETE FROM stock_tags \n                     WHERE stock_ticker = $1 \n                     AND tag_id IN (SELECT id FROM tags WHERE type = 'dynamic')`, [\n                    stock.ticker\n                ]);\n                // 应用新的动态标签\n                for (const tagName of tags){\n                    await applyTagToStock(client, stock.ticker, tagName, \"dynamic\");\n                }\n            } catch (tagError) {\n                console.error(`Error updating tags for ${stock.ticker}:`, tagError.message);\n                continue;\n            }\n        }\n        console.log(\"Dynamic tags update completed\");\n    } catch (error) {\n        console.error(\"Dynamic tags update failed:\", error);\n        throw error;\n    }\n}\n// 计算动态标签\nfunction calculateDynamicTags(stock) {\n    const tags = [];\n    // 基于市值的标签\n    if (stock.market_cap) {\n        if (stock.market_cap > 200000000000) tags.push(\"超大盘股\");\n        else if (stock.market_cap > 50000000000) tags.push(\"大盘股\");\n        else if (stock.market_cap > 10000000000) tags.push(\"中盘股\");\n        else if (stock.market_cap > 2000000000) tags.push(\"小盘股\");\n        else tags.push(\"微盘股\");\n    }\n    // 基于价格的标签\n    if (stock.last_price) {\n        if (stock.last_price > 500) tags.push(\"高价股\");\n        else if (stock.last_price > 100) tags.push(\"中价股\");\n        else if (stock.last_price < 10) tags.push(\"低价股\");\n    }\n    // 基于涨跌幅的标签\n    if (stock.change_percent) {\n        const change = parseFloat(stock.change_percent);\n        if (change > 5) tags.push(\"强势上涨\");\n        else if (change > 2) tags.push(\"温和上涨\");\n        else if (change < -5) tags.push(\"大幅下跌\");\n        else if (change < -2) tags.push(\"温和下跌\");\n    }\n    // 基于行业的标签\n    if (stock.sector_zh) {\n        tags.push(stock.sector_zh);\n    }\n    return tags;\n}\n// 应用标签到股票\nasync function applyTagToStock(client, ticker, tagName, tagType = \"dynamic\") {\n    try {\n        // 确保标签存在\n        const { rows: existingTags } = await client.query(\"SELECT id FROM tags WHERE name = $1 AND type = $2\", [\n            tagName,\n            tagType\n        ]);\n        let tagId;\n        if (existingTags.length > 0) {\n            tagId = existingTags[0].id;\n        } else {\n            // 创建新标签\n            const { rows: newTags } = await client.query(\"INSERT INTO tags (name, type) VALUES ($1, $2) RETURNING id\", [\n                tagName,\n                tagType\n            ]);\n            tagId = newTags[0].id;\n        }\n        // 关联股票和标签\n        await client.query(`INSERT INTO stock_tags (stock_ticker, tag_id) \n             VALUES ($1, $2) \n             ON CONFLICT (stock_ticker, tag_id) DO NOTHING`, [\n            ticker,\n            tagId\n        ]);\n    } catch (error) {\n        console.error(`Error applying tag ${tagName} to ${ticker}:`, error.message);\n    }\n}\n// 获取Polygon快照数据\nasync function getPolygonSnapshot(apiKey) {\n    let date = new Date();\n    for(let i = 0; i < 7; i++){\n        const tradeDate = date.toISOString().split(\"T\")[0];\n        const url = `https://api.polygon.io/v2/aggs/grouped/locale/us/market/stocks/${tradeDate}?adjusted=true&apiKey=${apiKey}`;\n        try {\n            console.log(`[Polygon] Attempting snapshot for ${tradeDate}...`);\n            const response = await fetch(url, {\n                signal: AbortSignal.timeout(15000)\n            });\n            if (response.ok) {\n                const data = await response.json();\n                if (data.results && data.results.length > 0) {\n                    console.log(`[Polygon] Success! Got ${data.results.length} stocks for ${tradeDate}`);\n                    return data.results;\n                }\n            }\n        } catch (error) {\n            console.log(`[Polygon] Failed for ${tradeDate}: ${error.message}`);\n        }\n        date.setDate(date.getDate() - 1);\n    }\n    return null;\n}\n// 获取Finnhub财务指标\nasync function getFinnhubMetrics(ticker, apiKey) {\n    try {\n        const url = `https://finnhub.io/api/v1/stock/metric?symbol=${ticker}&metric=all&token=${apiKey}`;\n        const response = await fetch(url, {\n            signal: AbortSignal.timeout(10000)\n        });\n        if (response.ok) {\n            const data = await response.json();\n            return data.metric;\n        }\n    } catch (error) {\n        console.log(`[Finnhub] Failed for ${ticker}: ${error.message}`);\n    }\n    return null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d2VicGFjazovL3RhZy1leHBsb3Jlci8uL3BhZ2VzL2FwaS91cGRhdGUtYWxsLWRhdGEuanM/OTJhOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAvYXBpL3VwZGF0ZS1hbGwtZGF0YS5qcyAtIOe7n+S4gOeahOaVsOaNruabtOaWsEFQSVxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICAgIC8vIOmqjOivgeaOiOadg1xuICAgIGlmIChyZXEuaGVhZGVyc1snYXV0aG9yaXphdGlvbiddICE9PSBgQmVhcmVyICR7cHJvY2Vzcy5lbnYuQ1JPTl9TRUNSRVR9YCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCI9PT09PSBTdGFydGluZyB1bmlmaWVkIGRhdGEgdXBkYXRlIGpvYiA9PT09PVwiKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgICAvLyDliJvlu7rmlbDmja7lupPov57mjqXmsaBcbiAgICAgICAgY29uc3QgeyBQb29sIH0gPSBhd2FpdCBpbXBvcnQoJ3BnJyk7XG4gICAgICAgIGNvbnN0IHBvb2wgPSBuZXcgUG9vbCh7XG4gICAgICAgICAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5ORU9OX0RBVEFCQVNFX1VSTCxcbiAgICAgICAgICAgIHNzbDogeyByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdCRUdJTicpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyDnrKzkuIDmraXvvJrmm7TmlrDogqHnpajln7rnoYDmlbDmja5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RlcCAxOiBVcGRhdGluZyBzdG9jayBkYXRhLi4uXCIpO1xuICAgICAgICAgICAgYXdhaXQgdXBkYXRlU3RvY2tEYXRhKGNsaWVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIOesrOS6jOatpe+8muabtOaWsOWKqOaAgeagh+etvlxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdGVwIDI6IFVwZGF0aW5nIGR5bmFtaWMgdGFncy4uLlwiKTtcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUR5bmFtaWNUYWdzKGNsaWVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnQ09NTUlUJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIj09PT09IEFsbCB1cGRhdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkgPT09PT1cIik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0FsbCBkYXRhIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnUk9MTEJBQ0snKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICAgICAgICAgIGF3YWl0IHBvb2wuZW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignVXBkYXRlIGpvYiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgICAgICAgZXJyb3I6ICdVcGRhdGUgZmFpbGVkJywgXG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyDmm7TmlrDogqHnpajmlbDmja7nmoTlh73mlbBcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrRGF0YShjbGllbnQpIHtcbiAgICB0cnkge1xuICAgICAgICAvLyDojrflj5ZQb2x5Z29u5b+r54Wn5pWw5o2uXG4gICAgICAgIGNvbnN0IHBvbHlnb25EYXRhID0gYXdhaXQgZ2V0UG9seWdvblNuYXBzaG90KHByb2Nlc3MuZW52LlBPTFlHT05fQVBJX0tFWSk7XG4gICAgICAgIGlmICghcG9seWdvbkRhdGEgfHwgcG9seWdvbkRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTm8gUG9seWdvbiBkYXRhIGF2YWlsYWJsZSwgc2tpcHBpbmcgc3RvY2sgdXBkYXRlcycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyAke3BvbHlnb25EYXRhLmxlbmd0aH0gc3RvY2tzIGZyb20gUG9seWdvbmApO1xuICAgICAgICBcbiAgICAgICAgLy8g5om56YeP5pu05paw6IKh56Wo5pWw5o2uXG4gICAgICAgIGZvciAoY29uc3Qgc3RvY2sgb2YgcG9seWdvbkRhdGEuc2xpY2UoMCwgMTAwKSkgeyAvLyDpmZDliLblpITnkIbmlbDph4/pgb/lhY3otoXml7ZcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGlja2VyID0gc3RvY2suVDtcbiAgICAgICAgICAgICAgICBjb25zdCBjbG9zZVByaWNlID0gc3RvY2suYztcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VQZXJjZW50ID0gKChzdG9jay5jIC0gc3RvY2subykgLyBzdG9jay5vICogMTAwKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIOiOt+WPlkZpbm5odWLotKLliqHmlbDmja5cbiAgICAgICAgICAgICAgICBjb25zdCBmaW5uaHViRGF0YSA9IGF3YWl0IGdldEZpbm5odWJNZXRyaWNzKHRpY2tlciwgcHJvY2Vzcy5lbnYuRklOTkhVQl9BUElfS0VZKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyDmm7TmlrDogqHnpajooahcbiAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAgICAgICAgICAgICAgIGBVUERBVEUgc3RvY2tzIFNFVCBcbiAgICAgICAgICAgICAgICAgICAgIGxhc3RfcHJpY2UgPSAkMSwgXG4gICAgICAgICAgICAgICAgICAgICBjaGFuZ2VfcGVyY2VudCA9ICQyLCBcbiAgICAgICAgICAgICAgICAgICAgIG1hcmtldF9jYXAgPSAkMyxcbiAgICAgICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlZCA9IE5PVygpXG4gICAgICAgICAgICAgICAgICAgICBXSEVSRSB0aWNrZXIgPSAkNGAsXG4gICAgICAgICAgICAgICAgICAgIFtjbG9zZVByaWNlLCBjaGFuZ2VQZXJjZW50LCBmaW5uaHViRGF0YT8ubWFya2V0Q2FwaXRhbGl6YXRpb24sIHRpY2tlcl1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBjYXRjaCAoc3RvY2tFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHVwZGF0aW5nIHN0b2NrICR7c3RvY2suVH06YCwgc3RvY2tFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ1N0b2NrIGRhdGEgdXBkYXRlIGNvbXBsZXRlZCcpO1xuICAgICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdTdG9jayBkYXRhIHVwZGF0ZSBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59XG5cbi8vIOabtOaWsOWKqOaAgeagh+etvueahOWHveaVsFxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRHluYW1pY1RhZ3MoY2xpZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8g6I635Y+W5omA5pyJ5pyJ5pWw5o2u55qE6IKh56WoXG4gICAgICAgIGNvbnN0IHsgcm93czogc3RvY2tzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAgICAgICBgU0VMRUNUIHRpY2tlciwgbmFtZV96aCwgc2VjdG9yX3poLCBtYXJrZXRfY2FwLCBsYXN0X3ByaWNlLCBcbiAgICAgICAgICAgICBjaGFuZ2VfcGVyY2VudCwgdm9sdW1lLCBwZV9yYXRpbyBcbiAgICAgICAgICAgICBGUk9NIHN0b2NrcyBcbiAgICAgICAgICAgICBXSEVSRSBsYXN0X3ByaWNlIElTIE5PVCBOVUxMIFxuICAgICAgICAgICAgIE9SREVSIEJZIG1hcmtldF9jYXAgREVTQyBOVUxMUyBMQVNUIFxuICAgICAgICAgICAgIExJTUlUIDIwMGBcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGR5bmFtaWMgdGFncyBmb3IgJHtzdG9ja3MubGVuZ3RofSBzdG9ja3NgKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3Qgc3RvY2sgb2Ygc3RvY2tzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIOiuoeeul+WKqOaAgeagh+etvlxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSBjYWxjdWxhdGVEeW5hbWljVGFncyhzdG9jayk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8g5riF55CG5pen55qE5Yqo5oCB5qCH562+XG4gICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgICAgICAgICAgICAgICBgREVMRVRFIEZST00gc3RvY2tfdGFncyBcbiAgICAgICAgICAgICAgICAgICAgIFdIRVJFIHN0b2NrX3RpY2tlciA9ICQxIFxuICAgICAgICAgICAgICAgICAgICAgQU5EIHRhZ19pZCBJTiAoU0VMRUNUIGlkIEZST00gdGFncyBXSEVSRSB0eXBlID0gJ2R5bmFtaWMnKWAsXG4gICAgICAgICAgICAgICAgICAgIFtzdG9jay50aWNrZXJdXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyDlupTnlKjmlrDnmoTliqjmgIHmoIfnrb5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHRhZ05hbWUgb2YgdGFncykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBhcHBseVRhZ1RvU3RvY2soY2xpZW50LCBzdG9jay50aWNrZXIsIHRhZ05hbWUsICdkeW5hbWljJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBjYXRjaCAodGFnRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB1cGRhdGluZyB0YWdzIGZvciAke3N0b2NrLnRpY2tlcn06YCwgdGFnRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdEeW5hbWljIHRhZ3MgdXBkYXRlIGNvbXBsZXRlZCcpO1xuICAgICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdEeW5hbWljIHRhZ3MgdXBkYXRlIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cblxuLy8g6K6h566X5Yqo5oCB5qCH562+XG5mdW5jdGlvbiBjYWxjdWxhdGVEeW5hbWljVGFncyhzdG9jaykge1xuICAgIGNvbnN0IHRhZ3MgPSBbXTtcbiAgICBcbiAgICAvLyDln7rkuo7luILlgLznmoTmoIfnrb5cbiAgICBpZiAoc3RvY2subWFya2V0X2NhcCkge1xuICAgICAgICBpZiAoc3RvY2subWFya2V0X2NhcCA+IDIwMDAwMDAwMDAwMCkgdGFncy5wdXNoKCfotoXlpKfnm5jogqEnKTtcbiAgICAgICAgZWxzZSBpZiAoc3RvY2subWFya2V0X2NhcCA+IDUwMDAwMDAwMDAwKSB0YWdzLnB1c2goJ+Wkp+ebmOiCoScpO1xuICAgICAgICBlbHNlIGlmIChzdG9jay5tYXJrZXRfY2FwID4gMTAwMDAwMDAwMDApIHRhZ3MucHVzaCgn5Lit55uY6IKhJyk7XG4gICAgICAgIGVsc2UgaWYgKHN0b2NrLm1hcmtldF9jYXAgPiAyMDAwMDAwMDAwKSB0YWdzLnB1c2goJ+Wwj+ebmOiCoScpO1xuICAgICAgICBlbHNlIHRhZ3MucHVzaCgn5b6u55uY6IKhJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIOWfuuS6juS7t+agvOeahOagh+etvlxuICAgIGlmIChzdG9jay5sYXN0X3ByaWNlKSB7XG4gICAgICAgIGlmIChzdG9jay5sYXN0X3ByaWNlID4gNTAwKSB0YWdzLnB1c2goJ+mrmOS7t+iCoScpO1xuICAgICAgICBlbHNlIGlmIChzdG9jay5sYXN0X3ByaWNlID4gMTAwKSB0YWdzLnB1c2goJ+S4reS7t+iCoScpO1xuICAgICAgICBlbHNlIGlmIChzdG9jay5sYXN0X3ByaWNlIDwgMTApIHRhZ3MucHVzaCgn5L2O5Lu36IKhJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIOWfuuS6jua2qOi3jOW5heeahOagh+etvlxuICAgIGlmIChzdG9jay5jaGFuZ2VfcGVyY2VudCkge1xuICAgICAgICBjb25zdCBjaGFuZ2UgPSBwYXJzZUZsb2F0KHN0b2NrLmNoYW5nZV9wZXJjZW50KTtcbiAgICAgICAgaWYgKGNoYW5nZSA+IDUpIHRhZ3MucHVzaCgn5by65Yq/5LiK5raoJyk7XG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZSA+IDIpIHRhZ3MucHVzaCgn5rip5ZKM5LiK5raoJyk7XG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZSA8IC01KSB0YWdzLnB1c2goJ+Wkp+W5heS4i+i3jCcpO1xuICAgICAgICBlbHNlIGlmIChjaGFuZ2UgPCAtMikgdGFncy5wdXNoKCfmuKnlkozkuIvot4wnKTtcbiAgICB9XG4gICAgXG4gICAgLy8g5Z+65LqO6KGM5Lia55qE5qCH562+XG4gICAgaWYgKHN0b2NrLnNlY3Rvcl96aCkge1xuICAgICAgICB0YWdzLnB1c2goc3RvY2suc2VjdG9yX3poKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRhZ3M7XG59XG5cbi8vIOW6lOeUqOagh+etvuWIsOiCoeelqFxuYXN5bmMgZnVuY3Rpb24gYXBwbHlUYWdUb1N0b2NrKGNsaWVudCwgdGlja2VyLCB0YWdOYW1lLCB0YWdUeXBlID0gJ2R5bmFtaWMnKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8g56Gu5L+d5qCH562+5a2Y5ZyoXG4gICAgICAgIGNvbnN0IHsgcm93czogZXhpc3RpbmdUYWdzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAgICAgICAnU0VMRUNUIGlkIEZST00gdGFncyBXSEVSRSBuYW1lID0gJDEgQU5EIHR5cGUgPSAkMicsXG4gICAgICAgICAgICBbdGFnTmFtZSwgdGFnVHlwZV1cbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGxldCB0YWdJZDtcbiAgICAgICAgaWYgKGV4aXN0aW5nVGFncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0YWdJZCA9IGV4aXN0aW5nVGFnc1swXS5pZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIOWIm+W7uuaWsOagh+etvlxuICAgICAgICAgICAgY29uc3QgeyByb3dzOiBuZXdUYWdzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAgICAgICAgICAgJ0lOU0VSVCBJTlRPIHRhZ3MgKG5hbWUsIHR5cGUpIFZBTFVFUyAoJDEsICQyKSBSRVRVUk5JTkcgaWQnLFxuICAgICAgICAgICAgICAgIFt0YWdOYW1lLCB0YWdUeXBlXVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRhZ0lkID0gbmV3VGFnc1swXS5pZDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8g5YWz6IGU6IKh56Wo5ZKM5qCH562+XG4gICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgICAgICAgIGBJTlNFUlQgSU5UTyBzdG9ja190YWdzIChzdG9ja190aWNrZXIsIHRhZ19pZCkgXG4gICAgICAgICAgICAgVkFMVUVTICgkMSwgJDIpIFxuICAgICAgICAgICAgIE9OIENPTkZMSUNUIChzdG9ja190aWNrZXIsIHRhZ19pZCkgRE8gTk9USElOR2AsXG4gICAgICAgICAgICBbdGlja2VyLCB0YWdJZF1cbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgYXBwbHlpbmcgdGFnICR7dGFnTmFtZX0gdG8gJHt0aWNrZXJ9OmAsIGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbn1cblxuLy8g6I635Y+WUG9seWdvbuW/q+eFp+aVsOaNrlxuYXN5bmMgZnVuY3Rpb24gZ2V0UG9seWdvblNuYXBzaG90KGFwaUtleSkge1xuICAgIGxldCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDc7IGkrKykge1xuICAgICAgICBjb25zdCB0cmFkZURhdGUgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLnBvbHlnb24uaW8vdjIvYWdncy9ncm91cGVkL2xvY2FsZS91cy9tYXJrZXQvc3RvY2tzLyR7dHJhZGVEYXRlfT9hZGp1c3RlZD10cnVlJmFwaUtleT0ke2FwaUtleX1gO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtQb2x5Z29uXSBBdHRlbXB0aW5nIHNuYXBzaG90IGZvciAke3RyYWRlRGF0ZX0uLi5gKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgxNTAwMCkgfSk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdHMgJiYgZGF0YS5yZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtQb2x5Z29uXSBTdWNjZXNzISBHb3QgJHtkYXRhLnJlc3VsdHMubGVuZ3RofSBzdG9ja3MgZm9yICR7dHJhZGVEYXRlfWApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbUG9seWdvbl0gRmFpbGVkIGZvciAke3RyYWRlRGF0ZX06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSAxKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbi8vIOiOt+WPlkZpbm5odWLotKLliqHmjIfmoIdcbmFzeW5jIGZ1bmN0aW9uIGdldEZpbm5odWJNZXRyaWNzKHRpY2tlciwgYXBpS2V5KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vZmlubmh1Yi5pby9hcGkvdjEvc3RvY2svbWV0cmljP3N5bWJvbD0ke3RpY2tlcn0mbWV0cmljPWFsbCZ0b2tlbj0ke2FwaUtleX1gO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoMTAwMDApIH0pO1xuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5tZXRyaWM7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0Zpbm5odWJdIEZhaWxlZCBmb3IgJHt0aWNrZXJ9OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufSJdLCJuYW1lcyI6WyJoYW5kbGVyIiwicmVxIiwicmVzIiwiaGVhZGVycyIsInByb2Nlc3MiLCJlbnYiLCJDUk9OX1NFQ1JFVCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJQb29sIiwicG9vbCIsImNvbm5lY3Rpb25TdHJpbmciLCJORU9OX0RBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsImNsaWVudCIsImNvbm5lY3QiLCJxdWVyeSIsInVwZGF0ZVN0b2NrRGF0YSIsInVwZGF0ZUR5bmFtaWNUYWdzIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZWxlYXNlIiwiZW5kIiwicG9seWdvbkRhdGEiLCJnZXRQb2x5Z29uU25hcHNob3QiLCJQT0xZR09OX0FQSV9LRVkiLCJsZW5ndGgiLCJzdG9jayIsInNsaWNlIiwidGlja2VyIiwiVCIsImNsb3NlUHJpY2UiLCJjIiwiY2hhbmdlUGVyY2VudCIsIm8iLCJ0b0ZpeGVkIiwiZmlubmh1YkRhdGEiLCJnZXRGaW5uaHViTWV0cmljcyIsIkZJTk5IVUJfQVBJX0tFWSIsIm1hcmtldENhcGl0YWxpemF0aW9uIiwic3RvY2tFcnJvciIsInJvd3MiLCJzdG9ja3MiLCJ0YWdzIiwiY2FsY3VsYXRlRHluYW1pY1RhZ3MiLCJ0YWdOYW1lIiwiYXBwbHlUYWdUb1N0b2NrIiwidGFnRXJyb3IiLCJtYXJrZXRfY2FwIiwicHVzaCIsImxhc3RfcHJpY2UiLCJjaGFuZ2VfcGVyY2VudCIsImNoYW5nZSIsInBhcnNlRmxvYXQiLCJzZWN0b3JfemgiLCJ0YWdUeXBlIiwiZXhpc3RpbmdUYWdzIiwidGFnSWQiLCJpZCIsIm5ld1RhZ3MiLCJhcGlLZXkiLCJkYXRlIiwiaSIsInRyYWRlRGF0ZSIsInNwbGl0IiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsIm9rIiwiZGF0YSIsInJlc3VsdHMiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsIm1ldHJpYyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/update-all-data.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupdate-all-data&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupdate-all-data.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();